// Skull.js 0.0.1-alpha
// Build Date: 2012-09-29

// (c) 2012 Kristofer Joseph.
// Skull may be freely distributed under the MIT license.
// For all details and documentation:
// http://www.skulljs.com
(function(e){"use strict";var t;typeof exports!="undefined"?t=exports:t=e.Skull=e.Skull||{},t.extend=Backbone.Model.extend})(this),function(e){"use strict";var t;typeof exports!="undefined"?t=exports:t=e.Skull=e.Skull||{};var n=t.EventMap=_.clone(Backbone.Events);n.publish=n.trigger,n.subscribe=n.on,n.unsubscribe=n.off}(this),function(e){"use strict";var t;typeof exports!="undefined"?t=exports:t=e.Skull=e.Skull||{};var n=t.CareTaker=function(){var e=[],t=[];return{addMemento:function(e){return this.undoStack.push(e),this},undo:function(){if(this.undoStack.length){var e=this.undoStack.pop(),t=e.originator;t&&t.setMemento&&t.createMemento&&(this.redoStack.push(t.createMemento()),t.setMemento(e))}return this},redo:function(){if(this.redoStack.length){var e=this.redoStack.pop(),t=e.originator;t&&t.setMemento&&t.createMemento&&(this.undoStack.push(t.createMemento()),t.setMemento(e))}return this}}}()}(this),function(e){"use strict";var t;typeof exports!="undefined"?t=exports:t=e.Skull=e.Skull||{};var n=t.Originator=Backbone.Model.extend({initialize:function(e){e&&e.eventMap?this.eventMap=e.eventMap:this.eventMap=t.EventMap}});_.extend(n.prototype,{createMemento:function(e){var n=new t.Memento({originator:this,state:this.changedAttributes(e)});return n},setMemento:function(e){var t=e.state;if(this.set)this.set(t);else{if(!this.reset)throw new Error("You need to override setMemento to supply a way to set your state");this.reset(t)}return this},store:function(e){return _.isEmpty(e)||(this.eventMap.trigger("Memento:Store",this.createMemento(e)),this.set(e)),this}}),n.extend=t.extend}(this),function(e){"use strict";var t;typeof exports!="undefined"?t=exports:t=e.Skull=e.Skull||{};var n=t.Memento=function(e){var t=e||{},n={},r={};_.extend(this,t)};_.extend(n.prototype,{getOriginator:function(){return this.originator},setOriginator:function(e){return this.originator=e,this},getState:function(){return this.state},setState:function(e){return this.state=e,this}})}(this),function(e){"use strict";var t;typeof exports!="undefined"?t=exports:t=e.Skull=e.Skull||{};var n=t.Command=function(){};_.extend(n.prototype,{execute:function(){return this}}),n.extend=t.extend}(this),function(e){"use strict";var t;typeof exports!="undefined"?t=exports:t=e.Skull=e.Skull||{};var n=t.CommandMap=function(e){var n=e||t.EventMap;return{addCommand:function(e,t){if(!t.execute)throw new Error("No execute method found");return n.on(e,t.execute),this},removeCommand:function(e,t){return n.off(e,t),this}}}()}(this);